{% extends "p3/base.html" %}
{% load conference i18n p3 assopy_tags %}
{% block EXTRA_HEAD %}
{% if form %}{{ form.media }}{% endif %}
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
{% endblock %}

{% block PAGE_TITLE %}{% p3_profile_data profile.user_id as profile_data %}{{ profile_data.name }}{% endblock %}

{% block HEADER %}
    {%comment%}Remove header completely to save space. In the future we may want to design a mini header instead?{%endcomment%}
{% endblock %}

{% block MAIN_CONTENT %}
{% p3_profile_data profile.user_id as profile_data %}

<!--
NAME AND PROFILE VISIBILITY
-->

<section id="profile-user-identity">
    <div class="grid-container">
        <div class="grid-100">
            <h1>{{ profile_data.name }}{% if full_access %} &mdash; {% trans "It’s you!" %}{% endif %}</h1>
            {% if full_access %}
                {% include "conference/profile_visibility_form.html" %}
            {% endif %}
        </div>
   </div>
</section>

<!--
AVATAR AND PERSONAL INFORMATION
-->

<section id="profile-user-identity">
    <div class="grid-container">
    <div class="grid-20">
        {% include "conference/profile_picture_form.html" %}
    </div>
    <div class="grid-80">
        {% include "conference/profile_publicdata_form.html" %}
    </div>
   </div>
</section>

<!--
BIO
-->

<section>
    <div class="grid-container">
    <div class="grid-80 prefix-20">
        {% include "conference/profile_bio_form.html" %}
   </div>
   </div>
</section>

<!--
TALKS AND TWITTER
-->
<section>
    <div class="grid-container">
    <div class="grid-50">
        {% current_conference as conf %}
        {% if conf.voting %}
            {% sum_ "talks" profile_data.talks.by_conf|attrib_:conf.code profile_data.talks.accepted.all %}
        {% else %}
            {% if full_access %}
                {% assign_ "talks" profile_data.talks.by_conf.all %}
            {% else %}
                {% assign_ "talks" profile_data.talks.accepted.all %}
            {% endif %}
        {% endif %}
        {% if talks %}
        <div class="speaker-talks well">
            <h2>{{ profile_data.name }}’s Talks</h2>
            <dl>
            {% for conf, talks_list in talks|ordered_talks %}
                <dt>{{ conf }}</dt>
                <dd><ul>
                {% for t in talks_list %}
                    <li><a href="{% url "conference-talk" slug=t.slug %}">{{ t.title }}</a>{% if t.status != "accepted" %} — {{ t.status }}{% endif %}</li>
                {% endfor %}
            {% endfor %}
                </ul></dd>
            </dl>
        </div>
        {% endif %}
        {% if profile_data.twitter %}
        <script src="https://widgets.twimg.com/j/2/widget.js"></script>
        <script>
        if(typeof(TWTR) != 'undefined') {
            new TWTR.Widget({
                version: 2,
                type: 'profile',
                rpp: 4,
                interval: 30000,
                width: 250,
                height: 300,
                theme: {
                    shell: {
                        background: '#E1DBC5',
                        color: '#301D1D'
                    },
                    tweets: {
                        background: '#ffffff',
                        color: '#301D1D',
                        links: '#0F2424'
                    }
                },
                features: {
                    scrollbar: false,
                    loop: false,
                    live: true,
                    behavior: 'default'
                }
            }).render().setUser('{{ profile_data.twitter }}').start();
        }
        </script>
        {% endif %}
 

   </div><!-- /grid -->
   </div><!-- /grid-container -->
</section>
{% endblock %}
